<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JustWatch-TV — Premium 4K Streaming</title>
    <meta name="description" content="Watch the latest Movies and TV Series in Ultra HD. No subscription required.">

    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect x=%2210%22 y=%2220%22 width=%2280%22 height=%2260%22 rx=%2210%22 fill=%22%236d28d9%22/><path d=%22M40 35 L70 50 L40 65 Z%22 fill=%22white%22/></svg>">

    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&family=Bebas+Neue&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg: #05010a;
            --surface: #0f051a;
            --accent: #ff004c; /* Vibrant Red */
            --purple: #8b5cf6; /* Vibrant Purple */
            --text: #ffffff;
            --text-dim: #94a3b8;
            --border: rgba(139, 92, 246, 0.15);
            --glow: rgba(255, 0, 76, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Plus Jakarta Sans', sans-serif; overflow-x: hidden; line-height: 1.5; }

        /* Header Style - Mobile Optimized */
        header {
            background: rgba(5, 1, 10, 0.9);
            backdrop-filter: blur(20px);
            padding: 10px 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border);
            position: sticky; top: 0; z-index: 1000;
        }

        /* Improved Pro Logo */
        .logo-container { display: flex; align-items: center; gap: 8px; text-decoration: none; }
        .logo-box {
            position: relative; width: 32px; height: 32px;
            background: linear-gradient(135deg, var(--purple), var(--accent));
            border-radius: 8px; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 15px var(--glow);
        }
        .logo-box::after { content: ''; position: absolute; inset: 2px; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; }
        .logo-text { 
            font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; letter-spacing: 0.5px;
            background: linear-gradient(to right, #fff, #8b5cf6);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .home-btn { 
            color: white; background: rgba(255,255,255,0.05);
            width: 35px; height: 35px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            text-decoration: none; border: 1px solid var(--border);
        }

        /* Video Stage */
        .video-stage { width: 100%; background: #000; position: relative; overflow: hidden; }
        .fake-player {
            width: 100%;
            aspect-ratio: 16/9;
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        .fake-player::before {
            content: ''; position: absolute; inset: 0;
            background: radial-gradient(circle, transparent 20%, rgba(0,0,0,0.8) 100%);
            z-index: 1;
        }

        /* CPA Register Lock - USA/UK Optimized */
        .register-overlay {
            position: absolute; inset: 0;
            background: rgba(0,0,0,0.92); backdrop-filter: blur(12px);
            z-index: 20; display: none; flex-direction: column;
            justify-content: center; align-items: center; padding: 25px; text-align: center;
        }
        .reg-box {
            background: var(--surface); border: 1px solid var(--purple);
            padding: 30px 20px; border-radius: 24px; width: 100%; max-width: 380px;
            box-shadow: 0 0 50px rgba(139, 92, 246, 0.2);
            animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .reg-box h3 { font-size: 1.4rem; margin-bottom: 12px; color: #fff; font-weight: 800; }
        .reg-box p { font-size: 0.9rem; color: var(--text-dim); margin-bottom: 25px; line-height: 1.4; }
        
        .cpa-link {
            display: block; width: 100%; background: linear-gradient(to right, var(--purple), var(--accent));
            color: white; text-decoration: none; padding: 15px; border-radius: 12px;
            font-weight: 800; font-size: 1rem; margin-bottom: 12px; text-transform: uppercase;
            box-shadow: 0 4px 15px var(--glow);
        }
        
        .trust-badges { display: flex; justify-content: center; gap: 15px; margin-top: 15px; opacity: 0.6; filter: grayscale(1); }
        .trust-badges i { font-size: 1.2rem; }

        /* Play Trigger Icon */
        .play-trigger {
            position: relative; z-index: 5;
            width: 70px; height: 70px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border: 2px solid #fff;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            color: white; font-size: 1.8rem;
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .play-trigger:hover { transform: scale(1.1); background: var(--accent); border-color: var(--accent); }

        /* Full Controls */
        .fake-controls {
            position: absolute; bottom: 0; left: 0; right: 0;
            height: 50px; background: linear-gradient(transparent, rgba(0,0,0,0.9));
            z-index: 10; display: flex; align-items: center; padding: 0 12px;
            gap: 12px; font-size: 0.85rem;
        }
        .progress-bar { position: absolute; top: 0; left: 0; right: 0; height: 3px; background: rgba(255,255,255,0.2); }
        .progress-fill { width: 42%; height: 100%; background: var(--accent); box-shadow: 0 0 10px var(--accent); }

        /* Info Section */
        .content-info { padding: 20px 15px; }
        #headTitle { font-size: 1.4rem; font-weight: 800; color: white; margin-bottom: 15px; letter-spacing: -0.5px; }
        
        .toolbar { display: flex; gap: 10px; margin-bottom: 25px; }
        .btn-action {
            flex: 1; background: var(--surface); color: white; border: 1px solid var(--border);
            padding: 12px; border-radius: 12px; font-weight: 700; font-size: 0.75rem;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-action.primary { background: linear-gradient(to right, var(--purple), var(--accent)); border: none; }

        /* Selectors */
        .selection-container { padding: 0 15px; margin-bottom: 30px; }
        .label-text { font-size: 0.7rem; font-weight: 800; color: var(--text-dim); text-transform: uppercase; margin-bottom: 8px; display: block; letter-spacing: 1px; }
        .select-box {
            background: var(--surface); border: 1px solid var(--border);
            border-radius: 12px; padding: 14px;
            display: flex; align-items: center; justify-content: space-between;
            cursor: pointer; margin-bottom: 10px; font-size: 0.9rem; font-weight: 600;
        }
        .dropdown-content {
            background: var(--surface); border: 1px solid var(--border); border-radius: 12px;
            margin-top: -5px; margin-bottom: 10px; display: none; max-height: 250px; overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .dropdown-item { padding: 12px 15px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 0.85rem; transition: 0.2s; }
        .dropdown-item:active { background: var(--purple); }

        /* Trending Section - Exactly 5 Items */
        .rec-section { margin-top: 10px; border-top: 1px solid var(--border); padding: 20px 15px; }
        .grid-5 {
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;
        }
        .rec-card { text-decoration: none; color: white; }
        .rec-img { 
            width: 100%; aspect-ratio: 2/3; border-radius: 6px; 
            background-size: cover; background-position: center;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .rec-info { font-size: 0.55rem; font-weight: 600; text-align: center; margin-top: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        footer { text-align: center; padding: 40px 20px; opacity: 0.4; font-size: 0.7rem; border-top: 1px solid var(--border); }

        /* Runtime/Time Display */
        .runtime-tag { font-size: 0.65rem; background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px; color: var(--text-dim); margin-left: auto; }
    </style>
</head>
<body>

<header>
    <a href="/" class="logo-container">
        <div class="logo-box"><i class="fas fa-play" style="font-size: 12px;"></i></div>
        <span class="logo-text">JUSTWATCH</span>
    </a>
    <a href="/" class="home-btn"><i class="fas fa-search" style="font-size: 14px;"></i></a>
</header>

<section class="video-stage">
    <div class="fake-player" id="backdropContainer" onclick="showRegister()">
        <div class="play-trigger" id="playIcon">
            <i class="fas fa-play" id="playSymbol" style="margin-left: 4px;"></i>
        </div>
        
        <!-- Premium CPA Register Lock -->
        <div class="register-overlay" id="regOverlay" onclick="event.stopPropagation()">
            <div class="reg-box">
                <i class="fas fa-shield-alt" style="font-size: 2.5rem; color: var(--purple); margin-bottom: 15px;"></i>
                <h3>MEMBERSHIP REQUIRED</h3>
                <p>Due to licensing in <b>USA/UK/AU</b>, you must verify your account to stream in Ultra HD 4K. Registration is 100% Free.</p>
                <a href="https://your-cpa-link.com" class="cpa-link">CREATE FREE ACCOUNT</a>
                <p style="font-size: 0.7rem; margin-bottom: 0;">Verified Secure. No Credit Card Required.</p>
                <div class="trust-badges">
                    <i class="fab fa-cc-visa"></i>
                    <i class="fab fa-cc-mastercard"></i>
                    <i class="fas fa-lock"></i>
                    <i class="fas fa-user-shield"></i>
                </div>
            </div>
        </div>

        <div class="fake-controls">
            <div class="progress-bar"><div class="progress-fill"></div></div>
            <i class="fas fa-play"></i>
            <i class="fas fa-volume-up"></i>
            <span id="timerDisplay" style="font-size: 0.65rem; font-weight: 600;">42:18 / 02:08:14</span>
            <div style="margin-left: auto; display: flex; gap: 12px;">
                <i class="fas fa-closed-captioning"></i>
                <i class="fas fa-cog"></i>
                <i class="fas fa-expand"></i>
            </div>
        </div>
    </div>
</section>

<div class="content-info">
    <h1 id="headTitle">LOADING...</h1>
    <div class="toolbar">
        <button class="btn-action primary" onclick="redirectToCPA()">
            <i class="fas fa-play"></i> <span>WATCH NOW</span>
        </button>
        <button class="btn-action" onclick="redirectToCPA()">
            <i class="fas fa-cloud-download-alt"></i> <span>DOWNLOAD</span>
        </button>
        <button class="btn-action" style="flex: 0.4;" onclick="shareMovie()">
            <i class="fas fa-share-alt"></i>
        </button>
    </div>
</div>

<main class="selection-container">
    <div id="tvControls" style="display:none;">
        <span class="label-text">Select Season</span>
        <div class="select-box" onclick="toggleDrop('seasonDrop')">
            <div style="display:flex; align-items:center; gap:10px;">
                <i class="fas fa-layer-group" style="color:var(--purple); font-size: 0.8rem;"></i> 
                <span id="sLabel">Season 1</span>
            </div>
            <i class="fas fa-chevron-down" style="font-size: 0.7rem; opacity: 0.5;"></i>
        </div>
        <div id="seasonDrop" class="dropdown-content"></div>

        <span class="label-text">Select Episode</span>
        <div class="select-box" onclick="toggleDrop('epDrop')">
            <div style="display:flex; align-items:center; gap:10px;">
                <i class="fas fa-play-circle" style="color:var(--accent); font-size: 0.8rem;"></i> 
                <span id="eLabel">Episode 1</span>
                <span class="runtime-tag" id="epRuntime">45 min</span>
            </div>
            <i class="fas fa-chevron-down" style="font-size: 0.7rem; opacity: 0.5;"></i>
        </div>
        <div id="epDrop" class="dropdown-content"></div>
    </div>
</main>

<section class="rec-section">
    <h2 class="label-text" style="margin-bottom: 15px;">Trending Worldwide</h2>
    <div class="grid-5" id="recGrid">
        <!-- Exactly 5 Recommendations -->
    </div>
</section>

<footer>
    <p>&copy; 2026 JUSTWATCH NETWORK. No Copyright Infringement Intended.</p>
    <p style="margin-top: 5px;">Server Status: <span style="color: #4ade80;">Online HD</span></p>
</footer>

<script>
    const API_KEY = '22be462e6d3de1dbab03d1ca50847b5a';
    const CPA_URL = 'https://your-cpa-link.com'; // Change this to your CPA link
    let id, type, currentS = 1, currentE = 1;
    let seriesData = null;

    const path = window.location.pathname.split("/").filter(Boolean);
    if (path[0] === "tv") {
        type = "tv"; id = path[1];
        currentS = parseInt(path[2]) || 1; currentE = parseInt(path[3]) || 1;
    } else if (path[0] === "movie") {
        type = "movie"; id = path[1];
    } else {
        const params = new URLSearchParams(window.location.search);
        id = params.get('id'); type = params.get('type');
        currentS = parseInt(params.get('s')) || 1; currentE = parseInt(params.get('e')) || 1;
    }

    async function init() {
        if (!id || !type) return;
        try {
            const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}&language=en-US`);
            const data = await res.json();
            seriesData = data;

            document.getElementById('headTitle').innerText = (data.title || data.name).toUpperCase();
            document.title = (data.title || data.name) + " — Watch Online HD";

            updateBackdrop(data.backdrop_path);

            if (type === 'tv') {
                document.getElementById('tvControls').style.display = 'block';
                renderSeasons();
                loadEpisodes(currentS, currentE);
            }
            loadRecommendations();
        } catch (e) { console.error("API Error", e); }
    }

    function updateBackdrop(path) {
        if (!path) return;
        const backdropUrl = `https://image.tmdb.org/t/p/w780${path}`;
        document.getElementById('backdropContainer').style.backgroundImage = `url('${backdropUrl}')`;
    }

    function showRegister() {
        const playSymbol = document.getElementById('playSymbol');
        playSymbol.className = "fas fa-circle-notch fa-spin";
        
        setTimeout(() => {
            document.getElementById('regOverlay').style.display = 'flex';
            document.getElementById('playIcon').style.display = 'none';
        }, 1000);
    }

    function redirectToCPA() {
        window.location.href = CPA_URL;
    }

    async function loadRecommendations() {
        const grid = document.getElementById('recGrid');
        try {
            const res = await fetch(`https://api.themoviedb.org/3/trending/all/week?api_key=${API_KEY}`);
            const data = await res.json();
            // Strictly 5 items
            grid.innerHTML = data.results.slice(0, 5).map(item => `
                <a href="/${item.media_type}/${item.id}" class="rec-card">
                    <div class="rec-img" style="background-image: url('https://image.tmdb.org/t/p/w200${item.poster_path}')"></div>
                    <div class="rec-info">${item.name || item.title}</div>
                </a>
            `).join('');
        } catch (e) { grid.innerHTML = ''; }
    }

    function renderSeasons() {
        const drop = document.getElementById('seasonDrop');
        if (!drop || !seriesData) return;
        drop.innerHTML = seriesData.seasons.filter(s => s.season_number > 0).map(s => `
            <div class="dropdown-item" onclick="selectSeason(${s.season_number})">Season ${s.season_number}</div>
        `).join('');
        document.getElementById('sLabel').innerText = `Season ${currentS}`;
    }

    function selectSeason(n) {
        currentS = n;
        document.getElementById('sLabel').innerText = `Season ${n}`;
        toggleDrop('seasonDrop');
        loadEpisodes(n, 1);
    }

    async function loadEpisodes(sNum, eNum = 1) {
        const drop = document.getElementById('epDrop');
        try {
            const res = await fetch(`https://api.themoviedb.org/3/tv/${id}/season/${sNum}?api_key=${API_KEY}`);
            const data = await res.json();
            const targetEp = data.episodes.find(ep => ep.episode_number == eNum) || data.episodes[0];
            
            updateBackdrop(targetEp.still_path || seriesData.backdrop_path);
            document.getElementById('epRuntime').innerText = (targetEp.runtime || 45) + ' min';
            
            document.getElementById('regOverlay').style.display = 'none';
            document.getElementById('playIcon').style.display = 'flex';
            document.getElementById('playSymbol').className = "fas fa-play";

            drop.innerHTML = data.episodes.map(ep => `
                <div class="dropdown-item" onclick="selectEpisode(${sNum}, ${ep.episode_number}, '${ep.still_path}', ${ep.runtime})">
                    Ep ${ep.episode_number}: ${ep.name}
                </div>
            `).join('');
            document.getElementById('eLabel').innerText = `Episode ${targetEp.episode_number}`;
        } catch (e) { console.error("Ep Error", e); }
    }

    function selectEpisode(s, e, stillPath, runtime) {
        currentE = e;
        document.getElementById('eLabel').innerText = `Episode ${e}`;
        document.getElementById('epRuntime').innerText = (runtime || 45) + ' min';
        toggleDrop('epDrop');
        
        if (stillPath && stillPath !== 'null') updateBackdrop(stillPath);
        else updateBackdrop(seriesData.backdrop_path);

        history.replaceState(null, "", `/tv/${id}/${s}/${e}`);
        
        document.getElementById('regOverlay').style.display = 'none';
        document.getElementById('playIcon').style.display = 'flex';
        document.getElementById('playSymbol').className = "fas fa-play";
    }

    function toggleDrop(dropId) {
        const el = document.getElementById(dropId);
        const current = el.style.display;
        document.querySelectorAll('.dropdown-content').forEach(d => d.style.display = 'none');
        el.style.display = current === 'block' ? 'none' : 'block';
    }

    function shareMovie() {
        if(navigator.share) navigator.share({ title: document.title, url: window.location.href });
        else alert("Link copied to clipboard!");
    }

    init();
</script>
</body>
</html>
